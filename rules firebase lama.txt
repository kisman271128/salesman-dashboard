{
  "rules": {
    // Visit events - real-time tracking data
    "visit_events": {
      ".read": "auth != null",
      ".write": "auth != null",
      ".indexOn": ["salesman_id", "timestamp", "event_name"],
      "$eventId": {
        ".validate": "newData.hasChildren(['salesman_id', 'event_name', 'timestamp'])",
        "salesman_id": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "timestamp": {
          ".validate": "newData.isString()"
        },
        "event_name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        }
      }
    },
    
    // Daily aggregated visit data
    "daily_visits": {
      ".read": "auth != null",
      ".write": "auth != null", 
      ".indexOn": ["date", "salesman_id"],
      "$salesmanId": {
        "$date": {
          ".validate": "newData.hasChildren(['salesman_name', 'date'])",
          "salesman_id": {
            ".validate": "newData.isString() && newData.val() === $salesmanId"
          }
        }
      }
    },
    
    // Salesman presence/status for real-time monitoring
    "salesman_presence": {
      ".read": "auth != null",
      "$salesmanId": {
        ".write": "auth != null",
        "status": {
          ".validate": "newData.val() === 'online' || newData.val() === 'offline'"
        },
        "lastSeen": {
          ".validate": "newData.isNumber()"
        }
      }
    },
    
    // Test data (dapat dihapus setelah testing)
    "test": {
      ".read": true,
      ".write": true
    }
  }
}