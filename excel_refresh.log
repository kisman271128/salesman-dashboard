2025-07-08 08:40:17 - === PARAMETER VALIDATION - XLSX ONLY ===
2025-07-08 08:40:17 - Received ExcelFile parameter: 'C:\Dashboard\DbaseSalesmanWebApp.xlsx'
2025-07-08 08:40:17 - === FINAL VALIDATION ===
2025-07-08 08:40:17 - Target Excel file: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:17 - File exists and accessible
2025-07-08 08:40:17 - File size: 4.03 MB
2025-07-08 08:40:17 - Last modified: 07/08/2025 08:38:29
2025-07-08 08:40:17 - Validated: Correct .xlsx file detected
2025-07-08 08:40:17 - ================================================
2025-07-08 08:40:17 - Excel Auto-Refresh Script - FIXED for .xlsx only
2025-07-08 08:40:17 - Target file: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:17 - Refresh wait time: 30 seconds
2025-07-08 08:40:17 - Max retries: 3
2025-07-08 08:40:17 - Method: Selective (only DbaseSalesmanWebApp.xlsx supported)
2025-07-08 08:40:17 - Excel file confirmed: DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:17 - Starting attempt 1 of 3
2025-07-08 08:40:17 - === Selective Refresh Attempt #1 ===
2025-07-08 08:40:17 - === Preparing file for refresh ===
2025-07-08 08:40:18 - File is not in use: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:18 - File is not in use, ready for refresh
2025-07-08 08:40:18 - Removing lock files for target file...
2025-07-08 08:40:18 - No lock files found for target file
2025-07-08 08:40:18 - File size: 4.03 MB
2025-07-08 08:40:18 - Last modified: 07/08/2025 08:38:29
2025-07-08 08:40:18 - File is not in use: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:18 - File access test: PASSED
2025-07-08 08:40:18 - Starting Excel application...
2025-07-08 08:40:21 - Excel application ready
2025-07-08 08:40:21 - Opening workbook...
2025-07-08 08:40:25 - Workbook opened: DbaseSalesmanWebApp.xlsx
2025-07-08 08:40:25 - Found 1 data connection(s)
2025-07-08 08:40:25 - Starting data refresh...
2025-07-08 08:41:55 - RefreshAll command executed
2025-07-08 08:41:55 - Waiting 30 seconds for refresh to complete...
2025-07-08 08:42:05 - Still waiting... (10/30 seconds)
2025-07-08 08:42:15 - Still waiting... (20/30 seconds)
2025-07-08 08:42:25 - Still waiting... (30/30 seconds)
2025-07-08 08:42:25 - Refresh phase completed in 120.4 seconds
2025-07-08 08:42:25 - Saving workbook...
2025-07-08 08:42:27 - Workbook saved successfully
2025-07-08 08:42:27 - File timestamp after save: 07/08/2025 08:42:27
2025-07-08 08:42:27 - File size after save: 4.14 MB
2025-07-08 08:42:27 - Closing workbook and Excel...
2025-07-08 08:42:29 - Workbook closed
2025-07-08 08:42:29 - Excel quit
2025-07-08 08:42:29 - COM cleanup completed
2025-07-08 08:42:29 - SUCCESS: Excel refresh completed successfully!
2025-07-08 08:42:29 - Final timestamp: 07/08/2025 08:42:27
2025-07-08 08:42:29 - Excel refresh succeeded on attempt #1
2025-07-08 08:42:29 - FINAL RESULT: Excel refresh completed successfully!
2025-07-08 08:42:29 - Total execution time: 131.9 seconds
2025-07-08 08:42:29 - System ready for dashboard update at 07:00
2025-07-08 08:52:14 - === PARAMETER VALIDATION - XLSX ONLY ===
2025-07-08 08:52:14 - Received ExcelFile parameter: 'C:\Dashboard\DbaseSalesmanWebApp.xlsx'
2025-07-08 08:52:14 - === FINAL VALIDATION ===
2025-07-08 08:52:14 - Target Excel file: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:14 - File exists and accessible
2025-07-08 08:52:14 - File size: 4.14 MB
2025-07-08 08:52:14 - Last modified: 07/08/2025 08:42:27
2025-07-08 08:52:14 - Validated: Correct .xlsx file detected
2025-07-08 08:52:14 - ================================================
2025-07-08 08:52:14 - Excel Auto-Refresh Script - FIXED for .xlsx only
2025-07-08 08:52:14 - Target file: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:14 - Refresh wait time: 30 seconds
2025-07-08 08:52:14 - Max retries: 3
2025-07-08 08:52:14 - Method: Selective (only DbaseSalesmanWebApp.xlsx supported)
2025-07-08 08:52:14 - Excel file confirmed: DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:14 - Starting attempt 1 of 3
2025-07-08 08:52:14 - === Selective Refresh Attempt #1 ===
2025-07-08 08:52:14 - === Preparing file for refresh ===
2025-07-08 08:52:14 - File is currently in use: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:14 - File is in use, attempting to close specific workbook...
2025-07-08 08:52:14 - Attempting to close specific workbook: DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:14 - Checking for existing Excel instances...
2025-07-08 08:52:14 - Found active Excel instance
2025-07-08 08:52:14 - Found 1 Excel process(es) running
2025-07-08 08:52:18 - Checking Excel instance with 16 workbook(s)
2025-07-08 08:52:18 - Checking workbook: Book1
2025-07-08 08:52:18 - Checking workbook: JKS Juli 2025.xlsx
2025-07-08 08:52:18 - Checking workbook: Upload Target Sales BTI Juli'25.xlsx
2025-07-08 08:52:18 - Checking workbook: jks fr bosnet 5 jul 2025.xls
2025-07-08 08:52:18 - Error checking workbook 4 : Exception calling "GetFullPath" with "1" argument(s): "The given path's format is not supported."
2025-07-08 08:52:18 - Checking workbook: Program Tactical Pull Out GD3 Juli 2025.xlsx
2025-07-08 08:52:18 - Checking workbook: Program Tactical Rosta 1.000 Juli 2025.xlsx
2025-07-08 08:52:18 - Checking workbook: Program Tactical Pull Out BPG Juli 2025.xlsx
2025-07-08 08:52:18 - Checking workbook: JKS Bosnet 05 Juli 2025.xls
2025-07-08 08:52:18 - Checking workbook: JKS Bosnet 05 Juli 2025 Revisi.xls
2025-07-08 08:52:18 - Checking workbook: MONITORING ITG BIMA Q3.xlsx
2025-07-08 08:52:18 - Checking workbook: Template_Upload_Peta_Tanjung2.csv
2025-07-08 08:52:18 - Checking workbook: Template_Upload_Peta_Tanjung2_enriched_2025-07-05T12-38-42.csv
2025-07-08 08:52:18 - Checking workbook: OutputBreakdownPOMTarget-0172-2025-07-07.xlsx
2025-07-08 08:52:18 - Checking workbook: OutputBreakdownWeeklyTarget-0172-2025-07-07.xlsx
2025-07-08 08:52:18 - Checking workbook: New Dashboard Sales Juli 2025.xlsm
2025-07-08 08:52:18 - Checking workbook: DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:18 - Found target workbook open in Excel
2025-07-08 08:52:18 - Workbook has unsaved changes, saving before close...
2025-07-08 08:52:19 - Successfully closed target workbook
2025-07-08 08:52:19 - Target workbook closed successfully
2025-07-08 08:52:21 - Successfully closed specific workbook
2025-07-08 08:52:24 - File is not in use: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:24 - File is now available for refresh
2025-07-08 08:52:24 - Removing lock files for target file...
2025-07-08 08:52:24 - No lock files found for target file
2025-07-08 08:52:24 - File size: 4.14 MB
2025-07-08 08:52:24 - Last modified: 07/08/2025 08:52:19
2025-07-08 08:52:24 - File is not in use: C:\Dashboard\DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:24 - File access test: PASSED
2025-07-08 08:52:24 - Starting Excel application...
2025-07-08 08:52:27 - Excel application ready
2025-07-08 08:52:27 - Opening workbook...
2025-07-08 08:52:31 - Workbook opened: DbaseSalesmanWebApp.xlsx
2025-07-08 08:52:31 - Found 1 data connection(s)
2025-07-08 08:52:31 - Starting data refresh...
2025-07-08 08:54:05 - RefreshAll command executed
2025-07-08 08:54:05 - Waiting 30 seconds for refresh to complete...
2025-07-08 08:54:15 - Still waiting... (10/30 seconds)
2025-07-08 08:54:25 - Still waiting... (20/30 seconds)
2025-07-08 08:54:35 - Still waiting... (30/30 seconds)
2025-07-08 08:54:35 - Refresh phase completed in 123.8 seconds
2025-07-08 08:54:35 - Saving workbook...
2025-07-08 08:54:36 - Workbook saved successfully
2025-07-08 08:54:36 - File timestamp after save: 07/08/2025 08:54:36
2025-07-08 08:54:36 - File size after save: 4.15 MB
2025-07-08 08:54:36 - Closing workbook and Excel...
2025-07-08 08:54:38 - Workbook closed
2025-07-08 08:54:38 - Excel quit
2025-07-08 08:54:38 - COM cleanup completed
2025-07-08 08:54:38 - SUCCESS: Excel refresh completed successfully!
2025-07-08 08:54:38 - Final timestamp: 07/08/2025 08:54:36
2025-07-08 08:54:38 - Excel refresh succeeded on attempt #1
2025-07-08 08:54:38 - FINAL RESULT: Excel refresh completed successfully!
2025-07-08 08:54:38 - Total execution time: 144.2 seconds
2025-07-08 08:54:38 - System ready for dashboard update at 07:00
