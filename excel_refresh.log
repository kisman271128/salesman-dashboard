2025-09-18 09:12:37 - === PARAMETER VALIDATION - XLSM ONLY ===
2025-09-18 09:12:37 - Received ExcelFile parameter: 'C:\Dashboard\DbaseSalesmanWebApp.xlsm'
2025-09-18 09:12:37 - === FINAL VALIDATION ===
2025-09-18 09:12:37 - Target Excel file: C:\Dashboard\DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:37 - File exists and accessible
2025-09-18 09:12:37 - File size: 29.01 MB
2025-09-18 09:12:37 - Last modified: 09/18/2025 09:06:34
2025-09-18 09:12:37 - Validated: Correct .xlsx file detected
2025-09-18 09:12:37 - ================================================
2025-09-18 09:12:37 - Excel Auto-Refresh Script - FIXED for .xlsm only
2025-09-18 09:12:37 - Target file: C:\Dashboard\DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:37 - Refresh wait time: 30 seconds
2025-09-18 09:12:37 - Max retries: 3
2025-09-18 09:12:37 - Method: Selective (only DbaseSalesmanWebApp.xlsm supported)
2025-09-18 09:12:37 - Excel file confirmed: DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:37 - Starting attempt 1 of 3
2025-09-18 09:12:37 - === Selective Refresh Attempt #1 ===
2025-09-18 09:12:37 - === Preparing file for refresh ===
2025-09-18 09:12:37 - File is currently in use: C:\Dashboard\DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:37 - File is in use, attempting to close specific workbook...
2025-09-18 09:12:37 - Attempting to close specific workbook: DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:37 - Checking for existing Excel instances...
2025-09-18 09:12:37 - Found active Excel instance
2025-09-18 09:12:38 - Found 2 Excel process(es) running
2025-09-18 09:12:38 - Checking Excel instance with 0 workbook(s)
2025-09-18 09:12:38 - Target workbook was not found in any Excel instance
2025-09-18 09:12:38 - Could not close specific workbook, file may be locked by another process
2025-09-18 09:12:38 - File preparation failed, trying fallback method...
2025-09-18 09:12:38 - AUTO: Terminating all Excel processes for automation...
2025-09-18 09:12:39 - Taskkill exit code: 0
2025-09-18 09:12:42 - All Excel processes terminated
2025-09-18 09:12:42 - Removing lock files for target file...
2025-09-18 09:12:42 - No lock files found for target file
2025-09-18 09:12:42 - File size: 29.01 MB
2025-09-18 09:12:42 - Last modified: 09/18/2025 09:06:34
2025-09-18 09:12:43 - File is not in use: C:\Dashboard\DbaseSalesmanWebApp.xlsm
2025-09-18 09:12:43 - File access test: PASSED
2025-09-18 09:12:43 - Starting Excel application...
2025-09-18 09:12:46 - Excel application ready
2025-09-18 09:12:46 - Opening workbook...
2025-09-18 09:13:08 - Workbook opened: DbaseSalesmanWebApp.xlsm
2025-09-18 09:13:08 - Found 1 data connection(s)
2025-09-18 09:13:08 - Starting data refresh...
2025-09-18 09:22:48 - RefreshAll command executed
2025-09-18 09:22:48 - Waiting 30 seconds for refresh to complete...
2025-09-18 09:22:58 - Still waiting... (10/30 seconds)
2025-09-18 09:23:09 - Still waiting... (20/30 seconds)
2025-09-18 09:23:19 - Still waiting... (30/30 seconds)
2025-09-18 09:23:19 - Refresh phase completed in 610.7 seconds
2025-09-18 09:23:19 - Saving workbook...
2025-09-18 09:23:25 - Workbook saved successfully
2025-09-18 09:23:25 - File timestamp after save: 09/18/2025 09:23:25
2025-09-18 09:23:25 - File size after save: 29.06 MB
2025-09-18 09:23:25 - Closing workbook and Excel...
2025-09-18 09:23:38 - Workbook closed
2025-09-18 09:23:38 - Excel quit
2025-09-18 09:23:38 - COM cleanup completed
2025-09-18 09:23:38 - SUCCESS: Excel refresh completed successfully!
2025-09-18 09:23:38 - Final timestamp: 09/18/2025 09:23:25
2025-09-18 09:23:38 - Excel refresh succeeded on attempt #1
2025-09-18 09:23:38 - FINAL RESULT: Excel refresh completed successfully!
2025-09-18 09:23:38 - Total execution time: 660.2 seconds
2025-09-18 09:23:38 - System ready for dashboard update at 07:00
