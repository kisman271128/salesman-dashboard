<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aplikasi POS Mobile</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@7.18.13/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      // State untuk autentikasi sederhana
      const [isLoggedIn, setIsLoggedIn] = useState(false);
      const [currentPage, setCurrentPage] = useState('login');
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');

      // State untuk data aplikasi
      const [products, setProducts] = useState([
        { id: '1', name: 'Kopi Arabica', price: 25000, quantity: 50 },
        { id: '2', name: 'Teh Hijau', price: 15000, quantity: 30 },
        { id: '3', name: 'Roti Bakar', price: 12000, quantity: 25 }
      ]);

      const [customers, setCustomers] = useState([
        { id: '1', name: 'Andi Wijaya', phone: '081234567890' },
        { id: '2', name: 'Sari Indah', phone: '081234567891' }
      ]);

      const [sales, setSales] = useState([
        { 
          id: '1', 
          customerId: '1', 
          productId: '1', 
          quantity: 2, 
          date: new Date('2025-08-20').toISOString() 
        }
      ]);

      // Auto login untuk demo (langsung masuk setelah 2 detik)
      useEffect(() => {
        console.log('App loaded, starting auto-login timer...');
        const timer = setTimeout(() => {
          console.log('Auto-login activated!');
          setIsLoggedIn(true);
          setCurrentPage('home');
        }, 2000);
        return () => clearTimeout(timer);
      }, []);

      // Komponen login
      const Login = () => {
        const handleLogin = () => {
          console.log('Manual login clicked');
          setIsLoggedIn(true);
          setCurrentPage('home');
        };

        return (
          <div className="p-4 flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
            <div className="w-full max-w-md bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-3xl font-bold text-center mb-6 text-gray-800">POS Mobile</h2>
              <p className="text-center text-gray-600 mb-4">ğŸš€ Demo Mode - Auto Login dalam 2 detik</p>
              <div className="space-y-4">
                <input 
                  type="email" 
                  placeholder="Email (opsional untuk demo)" 
                  value={email} 
                  onChange={(e) => setEmail(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <input 
                  type="password" 
                  placeholder="Password (opsional untuk demo)" 
                  value={password} 
                  onChange={(e) => setPassword(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <button 
                  onClick={handleLogin} 
                  className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg w-full font-medium transition-colors"
                >
                  Login Sekarang
                </button>
              </div>
              <div className="mt-4 text-center text-sm text-gray-500">
                <p>âœ¨ Aplikasi akan otomatis login</p>
                <p>ğŸ“± Semua fitur siap digunakan</p>
              </div>
            </div>
          </div>
        );
      };

      // Komponen navigasi
      const Navigation = () => (
        <nav className="bg-blue-600 text-white p-4">
          <div className="flex justify-between items-center">
            <h1 className="text-xl font-bold">ğŸª POS Mobile</h1>
            <button 
              onClick={() => {
                setIsLoggedIn(false);
                setCurrentPage('login');
              }} 
              className="px-3 py-1 bg-red-500 hover:bg-red-600 rounded transition-colors"
            >
              Logout
            </button>
          </div>
          <div className="mt-4 flex flex-wrap gap-2">
            <button 
              onClick={() => setCurrentPage('home')} 
              className={`px-3 py-2 rounded transition-colors ${currentPage === 'home' ? 'bg-blue-800' : 'bg-blue-700 hover:bg-blue-800'}`}
            >
              ğŸ  Beranda
            </button>
            <button 
              onClick={() => setCurrentPage('stock')} 
              className={`px-3 py-2 rounded transition-colors ${currentPage === 'stock' ? 'bg-blue-800' : 'bg-blue-700 hover:bg-blue-800'}`}
            >
              ğŸ“¦ Stok
            </button>
            <button 
              onClick={() => setCurrentPage('customers')} 
              className={`px-3 py-2 rounded transition-colors ${currentPage === 'customers' ? 'bg-blue-800' : 'bg-blue-700 hover:bg-blue-800'}`}
            >
              ğŸ‘¥ Konsumen
            </button>
            <button 
              onClick={() => setCurrentPage('sales')} 
              className={`px-3 py-2 rounded transition-colors ${currentPage === 'sales' ? 'bg-blue-800' : 'bg-blue-700 hover:bg-blue-800'}`}
            >
              ğŸ’° Penjualan
            </button>
            <button 
              onClick={() => setCurrentPage('reports')} 
              className={`px-3 py-2 rounded transition-colors ${currentPage === 'reports' ? 'bg-blue-800' : 'bg-blue-700 hover:bg-blue-800'}`}
            >
              ğŸ“Š Laporan
            </button>
          </div>
        </nav>
      );

      // Komponen beranda
      const Home = () => {
        const lowStockProducts = products.filter(p => p.quantity < 30);
        const totalRevenue = sales.reduce((total, sale) => {
          const product = products.find(p => p.id === sale.productId);
          return total + (product?.price || 0) * sale.quantity;
        }, 0);
        
        return (
          <div className="p-4">
            <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ¯ Dashboard POS</h2>
            
            {/* Summary Cards */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
              <div className="bg-white rounded-lg shadow-md p-6 text-center">
                <div className="text-3xl mb-2">ğŸ“¦</div>
                <h3 className="text-lg font-semibold text-blue-600">Total Produk</h3>
                <p className="text-3xl font-bold text-gray-800">{products.length}</p>
              </div>
              <div className="bg-white rounded-lg shadow-md p-6 text-center">
                <div className="text-3xl mb-2">ğŸ‘¥</div>
                <h3 className="text-lg font-semibold text-green-600">Total Konsumen</h3>
                <p className="text-3xl font-bold text-gray-800">{customers.length}</p>
              </div>
              <div className="bg-white rounded-lg shadow-md p-6 text-center">
                <div className="text-3xl mb-2">ğŸ›’</div>
                <h3 className="text-lg font-semibold text-purple-600">Total Penjualan</h3>
                <p className="text-3xl font-bold text-gray-800">{sales.length}</p>
              </div>
              <div className="bg-white rounded-lg shadow-md p-6 text-center">
                <div className="text-3xl mb-2">ğŸ’°</div>
                <h3 className="text-lg font-semibold text-yellow-600">Total Pendapatan</h3>
                <p className="text-2xl font-bold text-gray-800">Rp {totalRevenue.toLocaleString('id-ID')}</p>
              </div>
            </div>

            {/* Info Cards */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div className="bg-white rounded-lg shadow-md p-6">
                <h3 className="text-lg font-semibold mb-4 flex items-center">
                  <span className="mr-2">âš¡</span>
                  Status Aplikasi
                </h3>
                <div className="space-y-2">
                  <div className="flex justify-between">
                    <span>Mode:</span>
                    <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">Demo Lokal</span>
                  </div>
                  <div className="flex justify-between">
                    <span>Database:</span>
                    <span className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm">React State</span>
                  </div>
                  <div className="flex justify-between">
                    <span>Status:</span>
                    <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">âœ… Berjalan</span>
                  </div>
                </div>
              </div>

              <div className="bg-white rounded-lg shadow-md p-6">
                <h3 className="text-lg font-semibold mb-4 flex items-center">
                  <span className="mr-2">ğŸ“‹</span>
                  Menu Quick Actions
                </h3>
                <div className="space-y-3">
                  <button 
                    onClick={() => setCurrentPage('stock')}
                    className="w-full text-left px-4 py-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors"
                  >
                    ğŸ“¦ Kelola Produk & Stok
                  </button>
                  <button 
                    onClick={() => setCurrentPage('sales')}
                    className="w-full text-left px-4 py-2 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"
                  >
                    ğŸ’° Lakukan Penjualan
                  </button>
                  <button 
                    onClick={() => setCurrentPage('reports')}
                    className="w-full text-left px-4 py-2 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"
                  >
                    ğŸ“Š Lihat Laporan
                  </button>
                </div>
              </div>
            </div>

            <div className="mt-6 bg-green-50 border border-green-200 rounded-lg p-4">
              <h3 className="font-semibold text-green-800 mb-2">ğŸ‰ Selamat! Aplikasi Berhasil Berjalan</h3>
              <p className="text-green-700">Aplikasi POS Mobile siap digunakan. Semua fitur telah aktif dan dapat diakses melalui menu navigasi di atas.</p>
            </div>
          </div>
        );
      };

      // Komponen manajemen stok
      const StockManagement = () => {
        const [name, setName] = useState('');
        const [price, setPrice] = useState('');
        const [quantity, setQuantity] = useState('');

        const addProduct = () => {
          if (name && price && quantity) {
            const newProduct = {
              id: Date.now().toString(),
              name,
              price: parseFloat(price),
              quantity: parseInt(quantity)
            };
            setProducts(prev => [...prev, newProduct]);
            setName(''); 
            setPrice(''); 
            setQuantity('');
            alert('âœ… Produk berhasil ditambahkan!');
          } else {
            alert('âŒ Mohon isi semua field');
          }
        };

        const deleteProduct = (id) => {
          if (confirm('â“ Yakin ingin menghapus produk ini?')) {
            setProducts(prev => prev.filter(p => p.id !== id));
            alert('âœ… Produk berhasil dihapus!');
          }
        };

        return (
          <div className="p-4">
            <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ“¦ Manajemen Stok</h2>
            <div className="bg-white rounded-lg shadow-md p-6 mb-6">
              <h3 className="text-lg font-semibold mb-4">â• Tambah Produk Baru</h3>
              <div className="space-y-4">
                <input 
                  type="text" 
                  placeholder="Nama Produk" 
                  value={name} 
                  onChange={(e) => setName(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <input 
                  type="number" 
                  placeholder="Harga (Rp)" 
                  value={price} 
                  onChange={(e) => setPrice(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <input 
                  type="number" 
                  placeholder="Jumlah Stok" 
                  value={quantity} 
                  onChange={(e) => setQuantity(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <button 
                  onClick={addProduct} 
                  className="bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg w-full font-medium transition-colors"
                >
                  â• Tambah Produk
                </button>
              </div>
            </div>
            
            <div className="bg-white rounded-lg shadow-md p-6">
              <h3 className="text-lg font-semibold mb-4">ğŸ“‹ Daftar Produk</h3>
              <div className="space-y-3">
                {products.map(product => (
                  <div key={product.id} className="border border-gray-200 p-4 rounded-lg">
                    <div className="flex justify-between items-center">
                      <div>
                        <h4 className="font-semibold text-gray-800">{product.name}</h4>
                        <p className="text-gray-600">ğŸ’° Rp {product.price?.toLocaleString('id-ID')} | ğŸ“¦ Stok: {product.quantity}</p>
                      </div>
                      <button 
                        onClick={() => deleteProduct(product.id)} 
                        className="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded transition-colors"
                      >
                        ğŸ—‘ï¸ Hapus
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        );
      };

      // Komponen manajemen konsumen
      const CustomerManagement = () => {
        const [name, setName] = useState('');
        const [phone, setPhone] = useState('');

        const addCustomer = () => {
          if (name && phone) {
            const newCustomer = {
              id: Date.now().toString(),
              name,
              phone
            };
            setCustomers(prev => [...prev, newCustomer]);
            setName(''); 
            setPhone('');
            alert('âœ… Konsumen berhasil ditambahkan!');
          } else {
            alert('âŒ Mohon isi nama dan nomor telepon');
          }
        };

        return (
          <div className="p-4">
            <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ‘¥ Manajemen Konsumen</h2>
            <div className="bg-white rounded-lg shadow-md p-6 mb-6">
              <h3 className="text-lg font-semibold mb-4">â• Tambah Konsumen Baru</h3>
              <div className="space-y-4">
                <input 
                  type="text" 
                  placeholder="Nama Konsumen" 
                  value={name} 
                  onChange={(e) => setName(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <input 
                  type="text" 
                  placeholder="Nomor Telepon" 
                  value={phone} 
                  onChange={(e) => setPhone(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <button 
                  onClick={addCustomer} 
                  className="bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg w-full font-medium transition-colors"
                >
                  â• Tambah Konsumen
                </button>
              </div>
            </div>
            
            <div className="bg-white rounded-lg shadow-md p-6">
              <h3 className="text-lg font-semibold mb-4">ğŸ“‹ Daftar Konsumen</h3>
              <div className="space-y-3">
                {customers.map(customer => (
                  <div key={customer.id} className="border border-gray-200 p-4 rounded-lg">
                    <h4 className="font-semibold text-gray-800">ğŸ‘¤ {customer.name}</h4>
                    <p className="text-gray-600">ğŸ“± {customer.phone}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        );
      };

      // Komponen penjualan
      const Sales = () => {
        const [customerId, setCustomerId] = useState('');
        const [productId, setProductId] = useState('');
        const [quantity, setQuantity] = useState('');

        const addSale = () => {
          if (customerId && productId && quantity) {
            const product = products.find(p => p.id === productId);
            if (product && product.quantity >= parseInt(quantity)) {
              const newSale = {
                id: Date.now().toString(),
                customerId,
                productId,
                quantity: parseInt(quantity),
                date: new Date().toISOString()
              };
              setSales(prev => [...prev, newSale]);
              setProducts(prev => prev.map(p => 
                p.id === productId 
                  ? { ...p, quantity: p.quantity - parseInt(quantity) }
                  : p
              ));
              setCustomerId(''); 
              setProductId(''); 
              setQuantity('');
              alert('âœ… Penjualan berhasil dicatat!');
            } else {
              alert('âŒ Stok tidak cukup!');
            }
          } else {
            alert('âŒ Mohon isi semua field');
          }
        };

        return (
          <div className="p-4">
            <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ’° Penjualan</h2>
            <div className="bg-white rounded-lg shadow-md p-6 mb-6">
              <h3 className="text-lg font-semibold mb-4">ğŸ›’ Catat Penjualan Baru</h3>
              <div className="space-y-4">
                <select 
                  value={customerId} 
                  onChange={(e) => setCustomerId(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="">ğŸ‘¤ Pilih Konsumen</option>
                  {customers.map(customer => (
                    <option key={customer.id} value={customer.id}>{customer.name}</option>
                  ))}
                </select>
                <select 
                  value={productId} 
                  onChange={(e) => setProductId(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="">ğŸ“¦ Pilih Produk</option>
                  {products.filter(p => p.quantity > 0).map(product => (
                    <option key={product.id} value={product.id}>
                      {product.name} (Stok: {product.quantity})
                    </option>
                  ))}
                </select>
                <input 
                  type="number" 
                  placeholder="Jumlah" 
                  value={quantity} 
                  onChange={(e) => setQuantity(e.target.value)} 
                  className="border border-gray-300 p-3 w-full rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                />
                <button 
                  onClick={addSale} 
                  className="bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg w-full font-medium transition-colors"
                >
                  ğŸ’° Catat Penjualan
                </button>
              </div>
            </div>
            
            <div className="bg-white rounded-lg shadow-md p-6">
              <h3 className="text-lg font-semibold mb-4">ğŸ“‹ Riwayat Penjualan</h3>
              <div className="space-y-3">
                {sales.slice().reverse().map(sale => {
                  const customer = customers.find(c => c.id === sale.customerId);
                  const product = products.find(p => p.id === sale.productId);
                  return (
                    <div key={sale.id} className="border border-gray-200 p-4 rounded-lg">
                      <div className="flex justify-between items-start">
                        <div>
                          <h4 className="font-semibold">ğŸ‘¤ {customer?.name || 'Konsumen Tidak Diketahui'}</h4>
                          <p className="text-gray-600">ğŸ“¦ {product?.name || 'Produk Tidak Diketahui'}</p>
                          <p className="text-sm text-gray-500">Jumlah: {sale.quantity}</p>
                        </div>
                        <div className="text-right text-sm text-gray-500">
                          {new Date(sale.date).toLocaleDateString('id-ID')}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        );
      };

      // Komponen laporan
      const Reports = () => {
        const totalRevenue = sales.reduce((total, sale) => {
          const product = products.find(p => p.id === sale.productId);
          return total + (product?.price || 0) * sale.quantity;
        }, 0);

        const totalItems = sales.reduce((total, sale) => total + sale.quantity, 0);

        return (
          <div className="p-4">
            <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ“Š Laporan</h2>
            
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div className="bg-green-100 rounded-lg p-6 text-center">
                <div className="text-3xl mb-2">ğŸ’°</div>
                <h4 className="font-semibold text-green-800">Total Pendapatan</h4>
                <p className="text-2xl font-bold text-green-900">Rp {totalRevenue.toLocaleString('id-ID')}</p>
              </div>
              <div className="bg-blue-100 rounded-lg p-6 text-center">
                <div className="text-3xl mb-2">ğŸ›’</div>
                <h4 className="font-semibold text-blue-800">Total Transaksi</h4>
                <p className="text-2xl font-bold text-blue-900">{sales.length}</p>
              </div>
              <div className="bg-purple-100 rounded-lg p-6 text-center">
                <div className="text-3xl mb-2">ğŸ“¦</div>
                <h4 className="font-semibold text-purple-800">Item Terjual</h4>
                <p className="text-2xl font-bold text-purple-900">{totalItems}</p>
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-md p-6">
              <h3 className="text-lg font-semibold mb-4">ğŸ“ˆ Ringkasan Penjualan</h3>
              <div className="space-y-3">
                {sales.length === 0 ? (
                  <p className="text-gray-500 text-center py-8">ğŸ“­ Belum ada data penjualan</p>
                ) : (
                  sales.slice().reverse().map(sale => {
                    const customer = customers.find(c => c.id === sale.customerId);
                    const product = products.find(p => p.id === sale.productId);
                    const revenue = (product?.price || 0) * sale.quantity;
                    return (
                      <div key={sale.id} className="border border-gray-200 p-4 rounded-lg">
                        <div className="flex justify-between items-start">
                          <div>
                            <h4 className="font-semibold">ğŸ‘¤ {customer?.name || 'Konsumen Tidak Diketahui'}</h4>
                            <p className="text-gray-600">ğŸ“¦ {product?.name || 'Produk Tidak Diketahui'}</p>
                            <p className="text-sm text-gray-500">
                              Jumlah: {sale.quantity} Ã— Rp {(product?.price || 0).toLocaleString('id-ID')}
                            </p>
                          </div>
                          <div className="text-right">
                            <p className="font-semibold text-green-600">ğŸ’° Rp {revenue.toLocaleString('id-ID')}</p>
                            <p className="text-sm text-gray-500">ğŸ“… {new Date(sale.date).toLocaleDateString('id-ID')}</p>
                          </div>
                        </div>
                      </div>
                    );
                  })
                )}
              </div>
            </div>
          </div>
        );
      };

      // Debug info
      useEffect(() => {
        console.log('Current state:', { isLoggedIn, currentPage, products: products.length, customers: customers.length, sales: sales.length });
      }, [isLoggedIn, currentPage, products, customers, sales]);

      // Render halaman berdasarkan state
      return (
        <div className="min-h-screen bg-gray-50">
          {!isLoggedIn ? <Login /> : (
            <>
              <Navigation />
              <main>
                {currentPage === 'home' && <Home />}
                {currentPage === 'stock' && <StockManagement />}
                {currentPage === 'customers' && <CustomerManagement />}
                {currentPage === 'sales' && <Sales />}
                {currentPage === 'reports' && <Reports />}
              </main>
            </>
          )}
        </div>
      );
    }

    // Render aplikasi ke DOM
    console.log('Starting React app...');
    ReactDOM.render(<App />, document.getElementById('root'));
    console.log('React app rendered!');
  </script>
</body>
</html>